Name:           {{ blueprint['name'] }}-config
Version:        1.0
Release:        1
Summary:        Configuration RPM generated for Device Edge blueprint {{ blueprint['name'] }}
BuildArch:      x86_64
License:        MIT
%undefine _disable_source_fetch

%description
This RPM is automatically generated by the 'edge_compose_blueprint' Ansible role to be included in a Device Edge image

%build
mkdir -p ${RPM_BUILD_ROOT}/etc/ansible/facts.d
ln -sf /usr/etc/vendor/image_release.fact ${RPM_BUILD_ROOT}/etc/ansible/facts.d/image_release.fact

%files
/etc/ansible/facts.d/image_release.fact
{% for file in config_rpm_files['files'] %}
{{ file['path'] | regex_replace('/tmp/compose_' + blueprint['name'] + '/rpm/BUILDROOT/' + blueprint['name'] + '-config-1.0-1.x86_64', '') }}
{% endfor %}

%changelog
* Mon Jan 01 2024 Ansible <ansible@example.nl>
- Autogenerated RPM package
